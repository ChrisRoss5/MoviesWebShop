<!DOCTYPE html>
<html
        lang="en"
        xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
        layout:decorate="_layout"
>
<div layout:fragment="content">
    <div
            th:if="${purchases.isEmpty()}"
            role="alert"
            class="alert text-center flex justify-center"
    >
        <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                class="stroke-info shrink-0 w-6 h-6"
        >
            <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
            ></path>
        </svg>
        <span>No purchases made yet</span>
    </div>

    <div th:unless="${purchases.isEmpty()}" class="flex flex-col gap-3">
        <div th:each="purchase, iterStat : ${purchases.reversed()}"
             class="collapse collapse-arrow shadow-md rounded-md">
            <input type="radio" name="my-accordion-2"  th:checked="${iterStat.index == 0}"/>
            <div class="collapse-title text-xl font-medium flex flex-wrap gap-3">
                <div><span class="font-bold" th:text="${purchase.purchaseDate}"></span></div>
                <div>Movies purchased: <span class="font-bold" th:text="${purchase.purchaseMovies.size()}"></span></div>
                <div>Total price: <span class="font-bold" th:text="${purchase.totalAmount}"></span> €</div>
                <div>Payment method: <span class="font-bold" th:text="${purchase.paymentMethod}"></span></div>
            </div>
            <div class="collapse-content flex flex-col gap-6">
                <div
                        th:each="purchaseMovie : ${purchase.purchaseMovies}"
                        class="movie card shadow-md rounded-md overflow-hidden"
                >
                    <div class="flex flex-wrap gap-6 items-center">
                        <img
                                th:src="${purchaseMovie.movie.thumbnailUrl ?: '/images/no_image_placeholder.png'}"
                                alt="Movie Image"
                                class="w-40 aspect-video object-cover"
                        />
                        <div>
                            <div th:text="${purchaseMovie.movie.title}" class="font-bold text-xl"></div>
                            <div><span th:text="${purchaseMovie.movie.price}"></span> €</div>
                        </div>
                        <div
                                class="ml-auto pr-3"
                        >
                            Quantity: <span class="font-bold" th:text="${purchaseMovie.quantity}"></span>
                            (<span th:text="${purchaseMovie.quantity} * ${purchaseMovie.movie.price}"
                        ></span> €)
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <!--<div class="flex flex-wrap gap-3 justify-end mt-3">
            <div class="flex-1 basis-full text-right text-2xl font-bold">
                Total: <span id="final-price" class="font-bold"></span> €
            </div>
            <div id="empty-cart" class="btn btn-error btn-outline">
                <svg
                        xmlns="http://www.w3.org/2000/svg"
                        fill="none"
                        viewBox="0 0 24 24"
                        class="inline-block w-4 h-4 stroke-current"
                >
                    <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M6 18L18 6M6 6l12 12"
                    ></path>
                </svg>
                Empty cart
            </div>
            <div id="pay-with-cash" class="btn btn-accent">Pay with CASH</div>
            <div id="pay-with-paypal" class="btn btn-primary">Pay with PAYPAL</div>
        </div>-->
    </div>
</div>
</html>
